<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <title>登陆</title>
    <link rel="stylesheet" href="../assets/libs/particles/css/style.css">
    <link rel="stylesheet" href="../assets/css/base.css">
    <link rel="stylesheet" href="../assets/css/login.css" />
    <link rel="stylesheet" href="../layui/css/layui.css"/>
    <script src="../layui/layui.js"></script>
    <script src="md5/md5-min.js"></script>
</head>
<body>
<!-- particles.js container -->
<div id="particles-js"></div>
<div id="wrapper">
    <div>
    </div>
    <nav class="switch_nav">
        <a href="register.html" id="switch_signup" class="switch_btn">注册</a>
        <a href="javascript:;" id="switch_login" class="switch_btn on">登陆</a>
        <div class="switch_bottom" id="switch_bottom"></div>
    </nav>
    <div id="login">
        <form method="post" action="" id="fromData">
            <ul class="group_input">
                <li>
                    <input type="text" class="mobile required" name="phone" id="mobile" placeholder="手机号/资金账号" />
                </li>
                <li>
                    <input type="password" class="psd required" name="password" id="psd" placeholder="密码" />
                </li>
            </ul>
        </form>
        <button class="submit_btn" id="btnSubmit">登录</button>
        <div class="states">
            <span class="left"><a href="mobileLogin.html">手机验证码登陆</a></span>
            <span class="right"><a href="javascript:;">无法登陆？</a></span>
        </div>
        <div class="states">
        </div>
    </div>
    <div class="QRcode_btn">

    </div>
    <div id="footer">
    </div>
</div>
<script src="../assets/libs/jquery-1.12.4/jquery.min.js"></script>
<script src="../assets/libs/particles/particles.min.js"></script>
<script>
    layui.use('layer', function () {
        $(function () {
            //为表单元素添加失去焦点事件
            $("form :input").blur(function () {
                var $parent = $(this).parent();
                $parent.find(".msg").remove(); //删除以前的提醒元素（find()：查找匹配元素集中元素的所有匹配元素）
                //验证手机号
                if ($(this).is("#mobile")) {
                    var mobileVal = $.trim(this.value);
                    // var regMobile = /^1[3|4|5|7|8][0-9]{9}$/;
                    if (mobileVal == "") {
                        var errorMsg = " 请输入手机号或资金账号！";
                        $parent.append("<span class='msg onError'>" + errorMsg + "</span>");
                    } else {
                        var okMsg = " 输入正确";
                        $parent.append("<span class='msg onSuccess'>" + okMsg + "</span>");
                    }
                }
                //验证密码
                if ($(this).is("#psd")) {
                    var psdVal = $.trim(this.value);
                    var regPsd = /^(?![0-9]+$)(?![a-zA-Z]+$)[0-9A-Za-z]{6,20}$/;
                    if (psdVal == "" || !regPsd.test(psdVal)) {
                        var errorMsg = " 密码为6-20位字母、数字的组合！";
                        $parent.append("<span class='msg onError'>" + errorMsg + "</span>");
                    } else {
                        var okMsg = " 输入正确";
                        $parent.append("<span class='msg onSuccess'>" + okMsg + "</span>");
                    }
                }
            }).keyup(function () {
                //triggerHandler 防止事件执行完后，浏览器自动为标签获得焦点
                $(this).triggerHandler("blur");
            }).focus(function () {
                $(this).triggerHandler("blur");
            });

            //点击重置按钮时，通过trigger()来触发文本框的失去焦点事件
            $("#btnSubmit").click(function () {
                //trigger 事件执行完后，浏览器会为submit按钮获得焦点
                $("form .required:input").trigger("blur");
                var numError = $("form .onError").length;
                if (numError) {
                    return false;
                }
                //信息填写完整才能发送请求，（发送）
                var phone = $("#mobile").val();
                var pwd = hex_md5($("#psd").val()+"gty");
                $.post("/capiatilOrPhoneAndPasswordLogin", {"phone":phone,"password":pwd}, function (rs) {
                    console.log(rs)
                    if (rs.code == "20000") {
                        layer.msg(rs.msg);
                    } else if (rs.code == "20001") {
                        layer.msg(rs.msg);
                    }else{
                        layer.msg("系统正在维护...");
                    }
                })
            })
        })
    })

</script>
</body>
</html>
